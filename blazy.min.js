/*!
  [be]Lazy.js - v1.0.3 - 2013.08.27
  A lazy loading and multi-serving image script
  (c) Bjoern Klinggaard - @bklinggaard - http://dinbror.dk/blazy
*/
 var Blazy=function(l,h){function c(a){if(!h.querySelectorAll){var e=h.createStyleSheet();h.querySelectorAll=function(a,b,g,c,f){f=h.all;b=[];a=a.replace(/\[for\b/gi,"[htmlFor").split(",");for(g=a.length;g--;){e.addRule(a[g],"k:v");for(c=f.length;c--;)f[c].currentStyle.k&&b.push(f[c]);e.removeRule(0)}return b}}a=a||{};b.src=a.src||"data-src";b.multi=a.multi||!1;b.offset=a.offset||100;b.selector=a.selector||".b-lazy";b.onLoaded=a.onLoaded||!1;b.container=a.container?h.querySelectorAll(a.container):l;b.loadedClass=a.loadedClass||"b-loaded";m=b.src;f=s(n,20);p=s(t,50);t();u(b.selector);v(b.multi,function(a){if(a.width>=l.screen.width)return m=a.src,!1});q(b.container,"scroll",f);q(b.container,"resize",f);q(b.container,"resize",p);n()}function n(){for(var a=0;a<g;a++){var e=k[a].getBoundingClientRect(),d=w+b.offset;0<=e.left&&(e.left<=x+b.offset&&(0<=e.top&&e.top<=d||e.bottom<=d&&e.bottom>=0-b.offset))&&(y(k[a]),k.splice(a,1),g-=1,a--)}0===g&&c.prototype.destroy()}function y(a){if(0<a.offsetWidth&&0<a.offsetHeight&&-1===(" "+a.className+" ").indexOf(" "+b.loadedClass+" ")){var e=new Image,d=a.getAttribute(a.getAttribute(m)?m:b.src);v(b.multi,function(b){a.removeAttribute(b.src)});a.removeAttribute(b.src);e.onload=function(){a.parent?a.parent.replaceChild(e,a):a.src=d;a.className=a.className+" "+b.loadedClass;if(b.onLoaded)b.onLoaded(a)};e.src=d}}function u(a){a=h.querySelectorAll(a);for(var b=g=a.length;b--;k.unshift(a[b]));}function t(){w=l.innerHeight||h.documentElement.clientHeight;x=l.innerWidth||h.documentElement.clientWidth}function q(a,b,d){a.attachEvent?a.attachEvent&&a.attachEvent("on"+b,d):a.addEventListener(b,d,!1)}function r(a,b,d){a.detachEvent?a.detachEvent&&a.detachEvent("on"+b,d):a.removeEventListener(b,d,!1)}function v(a,b){if(a&&b)for(var d=a.length,c=0;c<d&&!1!==b(a[c],c);c++);}function s(a,b){var d=0;return function(){var c=+new Date;c-d<b||(d=c,a.apply(this,arguments))}}var m,b={},x,w,g=0,k=[],f,p;c.prototype.revalidate=function(){u(b.selector);n()};c.prototype.load=function(a){y(a)};c.prototype.destroy=function(){r(b.container,"scroll",f);r(b.container,"resize",f);r(b.container,"resize",p);g=0;k.length=0};return c}(window,document);