/*!
  [be]Lazy.js - v1.1.1 - 2013.12.27
  A lazy loading and multi-serving image script
  (c) Bjoern Klinggaard - @bklinggaard - http://dinbror.dk/blazy
*/
var Blazy=function(c,h){function k(a){if(!h.querySelectorAll){var d=h.createStyleSheet();h.querySelectorAll=function(a,b,c,f,g){g=h.all;b=[];a=a.replace(/\[for\b/gi,"[htmlFor").split(",");for(c=a.length;c--;){d.addRule(a[c],"k:v");for(f=g.length;f--;)g[f].currentStyle.k&&b.push(g[f]);d.removeRule(0)}return b}}a=a||{};b.src=a.src||"data-src";b.multi=a.multi||!1;b.error=a.error||!1;b.offset=a.offset||100;b.success=a.success||!1;b.selector=a.selector||".b-lazy";b.container=a.container?h.querySelectorAll(a.container):!1;b.errorClass=a.errorClass||"b-error";b.successClass=a.successClass||"b-loaded";q=b.src;f=t(u,20);r=t(v,50);v();m(b.multi,function(a){if(a.width>=c.screen.width)return q=a.src,!1});w()}function u(){for(var a=0;a<g;a++){var d=l[a],e=-1!==(" "+d.className+" ").indexOf(" "+b.successClass+" "),d=d.getBoundingClientRect(),c=x+b.offset;if(0<=d.left&&d.left<=y+b.offset&&(0<=d.top&&d.top<=c||d.bottom<=c&&d.bottom>=0-b.offset)||e)e||z(l[a]),l.splice(a,1),g-=1,a--}0===g&&k.prototype.destroy()}function z(a){if(0<a.offsetWidth&&0<a.offsetHeight){var d=a.getAttribute(q)||a.getAttribute(b.src);if(d){var e=new Image;m(b.multi,function(b){a.removeAttribute(b.src)});a.removeAttribute(b.src);e.onerror=function(){b.error&&b.error(a,"invalid");a.className=a.className+" "+b.errorClass};e.onload=function(){a.parent?a.parent.replaceChild(e,a):a.src=d;a.className=a.className+" "+b.successClass;b.success&&b.success(a)};e.src=d}else b.error&&b.error(a,"missing"),a.className=a.className+" "+b.errorClass}}function A(a){a=h.querySelectorAll(a);for(var b=g=a.length;b--;l.unshift(a[b]));}function v(){x=c.innerHeight||h.documentElement.clientHeight;y=c.innerWidth||h.documentElement.clientWidth}function w(){A(b.selector);s&&(s=!1,b.container&&m(b.container,function(a){n(a,"scroll",f)}),n(c,"scroll",f),n(c,"resize",f),n(c,"resize",r));u()}function n(a,b,e){a.attachEvent?a.attachEvent&&a.attachEvent("on"+b,e):a.addEventListener(b,e,!1)}function p(a,b,e){a.detachEvent?a.detachEvent&&a.detachEvent("on"+b,e):a.removeEventListener(b,e,!1)}function m(a,b){if(a&&b)for(var e=a.length,c=0;c<e&&!1!==b(a[c],c);c++);}function t(a,b){var c=0;return function(){var f=+new Date;f-c<b||(c=f,a.apply(this,arguments))}}var q,b={},y,x,s=!0,g=0,l=[],f,r;k.prototype.revalidate=function(){w()};k.prototype.load=function(a){z(a)};k.prototype.destroy=function(){s=!0;b.container&&m(b.container,function(a){p(a,"scroll",f)});p(c,"scroll",f);p(c,"resize",f);p(c,"resize",r);g=0;l.length=0};return k}(window,document);