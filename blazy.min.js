/*!
  [be]Lazy.js - v1.1.0 - 2013.11.22
  A lazy loading and multi-serving image script
  (c) Bjoern Klinggaard - @bklinggaard - http://dinbror.dk/blazy
*/
var Blazy=function(c,h){function k(a){if(!h.querySelectorAll){var f=h.createStyleSheet();h.querySelectorAll=function(a,b,c,e,g){g=h.all;b=[];a=a.replace(/\[for\b/gi,"[htmlFor").split(",");for(c=a.length;c--;){f.addRule(a[c],"k:v");for(e=g.length;e--;)g[e].currentStyle.k&&b.push(g[e]);f.removeRule(0)}return b}}a=a||{};b.src=a.src||"data-src";b.multi=a.multi||!1;b.error=a.error||!1;b.offset=a.offset||100;b.success=a.success||!1;b.selector=a.selector||".b-lazy";b.container=a.container?h.querySelectorAll(a.container):!1;b.loadedClass=a.loadedClass||"b-loaded";q=b.src;e=t(r,20);s=t(u,50);u();v(b.selector);m(b.multi,function(a){if(a.width>=c.screen.width)return q=a.src,!1});b.container&&m(b.container,function(a){n(a,"scroll",e)});n(c,"scroll",e);n(c,"resize",e);n(c,"resize",s);r()}function r(){for(var a=0;a<g;a++){var f=l[a].getBoundingClientRect(),d=w+b.offset;0<=f.left&&f.left<=x+b.offset&&(0<=f.top&&f.top<=d||f.bottom<=d&&f.bottom>=0-b.offset)&&(y(l[a]),l.splice(a,1),g-=1,a--)}0===g&&k.prototype.destroy()}function y(a){if(0<a.offsetWidth&&0<a.offsetHeight&&-1===(" "+a.className+" ").indexOf(" "+b.loadedClass+" ")){var f=a.getAttribute(q)||a.getAttribute(b.src);if(f){var d=new Image;m(b.multi,function(b){a.removeAttribute(b.src)});a.removeAttribute(b.src);d.onerror=function(){b.error&&b.error(a,"invalid")};d.onload=function(){a.parent?a.parent.replaceChild(d,a):a.src=f;a.className=a.className+" "+b.loadedClass;b.success&&b.success(a)};d.src=f}else b.error&&b.error(a,"missing")}}function v(a){a=h.querySelectorAll(a);for(var b=g=a.length;b--;l.unshift(a[b]));}function u(){w=c.innerHeight||h.documentElement.clientHeight;x=c.innerWidth||h.documentElement.clientWidth}function n(a,b,d){a.attachEvent?a.attachEvent&&a.attachEvent("on"+b,d):a.addEventListener(b,d,!1)}function p(a,b,d){a.detachEvent?a.detachEvent&&a.detachEvent("on"+b,d):a.removeEventListener(b,d,!1)}function m(a,b){if(a&&b)for(var d=a.length,c=0;c<d&&!1!==b(a[c],c);c++);}function t(a,b){var c=0;return function(){var e=+new Date;e-c<b||(c=e,a.apply(this,arguments))}}var q,b={},x,w,g=0,l=[],e,s;k.prototype.revalidate=function(){v(b.selector);r()};k.prototype.load=function(a){y(a)};k.prototype.destroy=function(){b.container&&m(b.container,function(a){p(a,"scroll",e)});p(c,"scroll",e);p(c,"resize",e);p(c,"resize",s);g=0;l.length=0};return k}(window,document);