/*===================================================================================================================
 * @name: [be]lazy
 * @type: javascript
 * @author: (c) Bjoern Klinggaard - @bklinggaard
 * @demo: http://dinbror.dk/blazy
 * @version: 1.0.1
 *==================================================================================================================*/
 var Blazy=function(m,n){function g(a){a=a||{};b.src=a.src||"data-src";b.multi=a.multi||!1;b.offset=a.offset||100;b.selector=a.selector||".b-lazy";b.onLoaded=a.onLoaded||!1;b.container=n.querySelector(a.container)||m;l=b.src;h=t(p,50);q=t(u,50);u();v(b.selector);w(b.multi,function(a){if(a.width>=m.screen.width)return l=a.src,!1});r(b.container,"scroll",h);r(b.container,"resize",h);r(b.container,"resize",q);p()}function p(){for(var a=0;a<f;a++){var c=k[a].getBoundingClientRect(),d=x+b.offset;if(0<=c.top&&0<=c.left&&c.top<=d||c.bottom<=d&&c.bottom>=0-b.offset)y(k[a]),k.splice(a,1),f-=1,a--}0===f&&g.prototype.destroy()}function y(a){if(0<a.offsetWidth&&0<a.offsetHeight&&-1===(" "+a.className+" ").indexOf(" loaded ")){var c=new Image,d=a.getAttribute(a.getAttribute(l)?l:b.src);w(b.multi,function(c){a.removeAttribute(c.src)});a.removeAttribute(b.src);c.onload=function(){a.parent?a.parent.replaceChild(c,a):a.src=d;a.className+=" loaded";b.onLoaded(a)};c.src=d}}function v(a){a=n.querySelectorAll(a);for(var c=f=a.length;c--;k.unshift(a[c]));}function u(){x=m.innerHeight||n.documentElement.clientHeight}function r(a,c,b){a.attachEvent?a.attachEvent&&a.attachEvent("on"+c,b):a.addEventListener(c,b,!1)}function s(a,b,d){a.detachEvent?a.detachEvent&&el.detachEvent("on"+b,d):a.removeEventListener(b,d,!1)}function w(a,b){if(a&&b)for(var d=a.length,e=0;e<d&&!1!==b(a[e],e);e++);}function t(a,b){var d=0;return function(){var e=+new Date;e-d<b||(d=e,a.apply(this,arguments))}}var l,b={},f=0,x,k=[],h,q;g.prototype.revalidate=function(){v(b.selector);p()};g.prototype.load=function(a){y(a)};g.prototype.destroy=function(){s(b.container,"scroll",h);s(b.container,"resize",h);s(b.container,"resize",q);f=0;k=[]};return g}(window,document);